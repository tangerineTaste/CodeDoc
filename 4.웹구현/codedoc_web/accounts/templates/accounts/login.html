{% extends "base.html" %}
{% load static %}

{% block title %}CodeDoc - 로그인{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'accounts/css/auth.css' %}?v={{ STATIC_VERSION }}">
{% endblock %}

{% block content %}
<div class="login-page-container">
    <div class="login-card">
        <div class="login-header">
            <h1 class="login-title">로그인</h1>
            <p class="login-subtitle">
                안전하고 편리한 금융 서비스를<br>
                이용하기 위해 로그인해주세요.
            </p>
        </div>

        <form class="login-form" method="post">
            {% csrf_token %}
            
            {% if form.errors %}
                <div class="error-messages">
                    {% for field, errors in form.errors.items %}
                        {% for error in errors %}
                            <div class="error-message">{{ error }}</div>
                        {% endfor %}
                    {% endfor %}
                </div>
            {% endif %}

            <div class="form-group">
                <label for="id_username" class="form-label">아이디</label>
                <input type="text" name="username" id="id_username" class="form-input" 
                       placeholder="아이디를 입력하세요" required>
            </div>

            <div class="form-group">
                <label for="id_password" class="form-label">비밀번호</label>
                <div class="password-input-group">
                    <input type="password" name="password" id="id_password" class="form-input" 
                           placeholder="비밀번호를 입력하세요" required>
                    <button type="button" class="password-toggle" data-target="id_password">
                        <svg class="eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none">
                            <path d="M1 12S5 4 12 4s11 8 11 8-4 8-11 8S1 12 1 12z" stroke="currentColor" stroke-width="2"/>
                            <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2"/>
                        </svg>
                    </button>
                </div>
            </div>

            <div class="form-options">
                <label class="checkbox-wrapper">
                    <input type="checkbox" name="remember_me" class="checkbox-input">
                    <span class="checkbox-label">로그인 상태 유지</span>
                </label>
            </div>

            <button type="submit" class="login-button">
                <span class="button-text">로그인</span>
                <div class="button-loader" style="display: none;">
                    <div class="spinner"></div>
                </div>
            </button>
        </form>

        <div class="login-links">
            <a href="#" class="auth-link">아이디 찾기</a>
            <span class="separator">|</span>
            <a href="#" class="auth-link">비밀번호 찾기</a>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/auth.js' %}"></script>
<script>
// 로그인 페이지 전용 비밀번호 토글
document.addEventListener('DOMContentLoaded', function() {
    const passwordToggle = document.querySelector('.password-toggle');
    
    if (passwordToggle) {
        passwordToggle.addEventListener('click', function() {
            const passwordInput = document.getElementById('id_password');
            const eyeIcon = this.querySelector('.eye-icon');
            
            if (passwordInput && eyeIcon) {
                if (passwordInput.type === 'password') {
                    passwordInput.type = 'text';
                    eyeIcon.innerHTML = `
                        <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94L17.94 17.94z" stroke="currentColor" stroke-width="2"/>
                        <path d="M1 1l22 22" stroke="currentColor" stroke-width="2"/>
                        <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2"/>
                    `;
                } else {
                    passwordInput.type = 'password';
                    eyeIcon.innerHTML = `
                        <path d="M1 12S5 4 12 4s11 8 11 8-4 8-11 8S1 12 1 12z" stroke="currentColor" stroke-width="2"/>
                        <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2"/>
                    `;
                }
            }
        });
    }
});
</script>
{% endblock %}