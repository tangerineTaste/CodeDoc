{% extends 'base.html' %}
{% load static %}

{% block title %}ìƒí’ˆì†Œê°œ - CODEDOC{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'product_recommendation/css/product_list.css' %}?v={{ STATIC_VERSION }}">
{% endblock %}

{% block content %}
<div class="container">
    <!-- í˜ì´ì§€ í—¤ë” -->
    <div class="page-header">
        <h1 class="page-title">ë¬´ì—‡ì„ ë³´ì¥í•´ ë“œë¦´ê¹Œìš”?</h1>
        <p class="page-subtitle">ê³ ê°ë‹˜ê»˜ ë§ëŠ” ìµœì ì˜ ê¸ˆìœµìƒí’ˆì„ ì°¾ì•„ë³´ì„¸ìš”</p>
    </div>

    <!-- AI ì¶”ì²œ ìƒí’ˆ ì„¹ì…˜ -->
    {% if recommended_products %}
    <div class="recommendation-section">
        <h2 class="section-title">íšŒì›ë‹˜ì„ ìœ„í•œ AI ì¶”ì²œ ìƒí’ˆ ğŸ’</h2>
        <div class="products-grid">
            {% for product in recommended_products %}
                <div class="product-cards">
                    <span class="product-badge recommended-badge">{{ product.product_type_name }}</span>
                    <h3 class="product-name">{{ product.fin_prdt_nm }}</h3>
                    <p class="product-subtitle">AIê°€ íšŒì›ë‹˜ì˜ í”„ë¡œí•„ì„ ë¶„ì„í•˜ì—¬ ì¶”ì²œí•˜ëŠ” ë§ì¶¤ ìƒí’ˆì…ë‹ˆë‹¤.</p>
                    
                    <div class="product-info">
                        <div class="info-label">ê¸ˆìœµíšŒì‚¬</div>
                        <div class="info-value">{{ product.kor_co_nm }}</div>
                    </div>
                    
                    <div class="product-info">
                        <div class="info-label">ê°€ì…ë°©ë²•</div>
                        <div class="info-value">{{ product.join_way|default:"ì˜¨ë¼ì¸ ê°€ì… ê°€ëŠ¥" }}</div>
                    </div>
                    
                    <div class="product-tags">
                        <span class="tag">#AIì¶”ì²œ</span>
                        <span class="tag">#ë§ì¶¤ìƒí’ˆ</span>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    <!-- í•„í„° íƒ­ -->
    <div class="filter-tabs">
        <button class="filter-btn active" data-filter="all">ì „ì²´</button>
        <button class="filter-btn" data-filter="deposit">ì˜ˆê¸ˆ</button>
        <button class="filter-btn" data-filter="saving">ì ê¸ˆ</button>
        <button class="filter-btn" data-filter="loan">ëŒ€ì¶œ</button>
    </div>

    {% if error %}
        <div class="error-message">
            <h3>ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤</h3>
            <p>{{ error }}</p>
        </div>
    {% else %}
        <!-- ì „ì²´ ìƒí’ˆ ì„¹ì…˜ -->
        <div class="products-section" data-category="all">
            <h2 class="section-title">ì „ì²´ {{ all_total }}ê°œ ìƒí’ˆ</h2>
            <div class="products-grid">
                {% for product in all_products %}
                    <div class="product-cards">
                        <span class="product-badge">{{ product.product_type_name }}/ë³´ì¥</span>
                        <h3 class="product-name">{{ product.fin_prdt_nm }}</h3>
                        <p class="product-subtitle">
                            {% if product.product_type == 'deposit' %}
                                ì†Œì¤‘í•œ ë‚´ ê°€ì¡±ì„ ìœ„í•œ í˜„ëª…í•œ ì„ íƒ!
                            {% else %}
                                ì„¸ë°”ë¥¼ê³¨ê³ ì˜ ë“ ë“ í•œ ì„¸ê°€ì§€ ì•½ì†!
                            {% endif %}
                        </p>
                        
                        <div class="product-info">
                            <div class="info-label">ìƒí’ˆ ìœ í˜•</div>
                            <div class="info-value">{{ product.product_type_name }}</div>
                        </div>
                        
                        <div class="product-info">
                            <div class="info-label">ê¸ˆìœµíšŒì‚¬</div>
                            <div class="info-value">{{ product.kor_co_nm }}</div>
                        </div>
                        
                        <div class="product-info">
                            <div class="info-label">ê°€ì…ë°©ë²•</div>
                            <div class="info-value">{{ product.join_way|default:"ì˜¨ë¼ì¸ ê°€ì… ê°€ëŠ¥" }}</div>
                        </div>
                        
                        <div class="product-tags">
                            {% if product.product_type == 'deposit' %}
                                <span class="tag">#ë³´ì¥</span>
                                <span class="tag">#ì˜ˆê¸ˆ</span>
                                <span class="tag">#ì•ˆì „</span>
                            {% else %}
                                <span class="tag">#ì„±ì¸ìš°ëŒ€í˜œíƒ</span>
                                <span class="tag">#ì ê¸ˆ</span>
                                <span class="tag">#ì €ì¶•</span>
                            {% endif %}
                        </div>
                    </div>
                {% empty %}
                    <p>ìƒí’ˆì´ ì—†ìŠµë‹ˆë‹¤.</p>
                {% endfor %}
            </div>
            
            <!-- ì „ì²´ ìƒí’ˆ í˜ì´ì§€ë„¤ì´ì…˜ -->
            {% if all_products.has_other_pages %}
                <div class="pagination-container">
                    <div class="pagination">
                        {% if all_products.has_previous %}
                            <a href="?page={{ all_products.previous_page_number }}">&lsaquo; ì´ì „</a>
                        {% endif %}
                        
                        {% for num in all_products.paginator.page_range %}
                            {% if num <= 5 %}
                                {% if all_products.number == num %}
                                    <span class="current">{{ num }}</span>
                                {% else %}
                                    <a href="?page={{ num }}">{{ num }}</a>
                                {% endif %}
                            {% endif %}
                        {% endfor %}
                        
                        {% if all_products.has_next %}
                            <a href="?page={{ all_products.next_page_number }}">ë‹¤ìŒ &rsaquo;</a>
                        {% endif %}
                    </div>
                    <div class="pagination-info">
                        {{ all_products.start_index }}-{{ all_products.end_index }} / ì´ {{ all_total }}ê°œ
                    </div>
                </div>
            {% endif %}
        </div>

        <!-- ì˜ˆê¸ˆ ìƒí’ˆ ì„¹ì…˜ -->
        <div class="products-section" data-category="deposit" style="display: none;">
            <h2 class="section-title">ì˜ˆê¸ˆ {{ deposits_total }}ê°œ ìƒí’ˆ</h2>
            <div class="products-grid">
                {% for product in deposits %}
                    <div class="product-cards">
                        <span class="product-badge">ì˜ˆê¸ˆ/ë³´ì¥</span>
                        <h3 class="product-name">{{ product.fin_prdt_nm }}</h3>
                        <p class="product-subtitle">ì†Œì¤‘í•œ ë‚´ ê°€ì¡±ì„ ìœ„í•œ í˜„ëª…í•œ ì„ íƒ!</p>
                        
                        <div class="product-info">
                            <div class="info-label">ê¸ˆìœµíšŒì‚¬</div>
                            <div class="info-value">{{ product.kor_co_nm }}</div>
                        </div>
                        
                        <div class="product-info">
                            <div class="info-label">ê°€ì…ë°©ë²•</div>
                            <div class="info-value">{{ product.join_way|default:"ì˜¨ë¼ì¸ ê°€ì… ê°€ëŠ¥" }}</div>
                        </div>
                        
                        <div class="product-tags">
                            <span class="tag">#ë³´ì¥</span>
                            <span class="tag">#ì˜ˆê¸ˆ</span>
                            <span class="tag">#ì•ˆì „</span>
                        </div>
                    </div>
                {% empty %}
                    <p>ì˜ˆê¸ˆ ìƒí’ˆì´ ì—†ìŠµë‹ˆë‹¤.</p>
                {% endfor %}
            </div>
            
            <!-- ì˜ˆê¸ˆ í˜ì´ì§€ë„¤ì´ì…˜ -->
            {% if deposits.has_other_pages %}
                <div class="pagination-container">
                    <div class="pagination">
                        {% if deposits.has_previous %}
                            <a href="?deposits_page={{ deposits.previous_page_number }}">&lsaquo; ì´ì „</a>
                        {% endif %}
                        
                        {% for num in deposits.paginator.page_range %}
                            {% if num <= 5 %}
                                {% if deposits.number == num %}
                                    <span class="current">{{ num }}</span>
                                {% else %}
                                    <a href="?deposits_page={{ num }}">{{ num }}</a>
                                {% endif %}
                            {% endif %}
                        {% endfor %}
                        
                        {% if deposits.has_next %}
                            <a href="?deposits_page={{ deposits.next_page_number }}">ë‹¤ìŒ &rsaquo;</a>
                        {% endif %}
                    </div>
                    <div class="pagination-info">
                        {{ deposits.start_index }}-{{ deposits.end_index }} / ì´ {{ deposits_total }}ê°œ
                    </div>
                </div>
            {% endif %}
        </div>

        <!-- ì ê¸ˆ ìƒí’ˆ ì„¹ì…˜ -->
        <div class="products-section" data-category="saving" style="display: none;">
            <h2 class="section-title">ì ê¸ˆ {{ savings_total }}ê°œ ìƒí’ˆ</h2>
            <div class="products-grid">
                {% for product in savings %}
                    <div class="product-cards">
                        <span class="product-badge">ì ê¸ˆ/ë³´ì¥</span>
                        <h3 class="product-name">{{ product.fin_prdt_nm }}</h3>
                        <p class="product-subtitle">ì„¸ë°”ë¥¼ê³¨ê³ ì˜ ë“ ë“ í•œ ì„¸ê°€ì§€ ì•½ì†!</p>
                        
                        <div class="product-info">
                            <div class="info-label">ê¸ˆìœµíšŒì‚¬</div>
                            <div class="info-value">{{ product.kor_co_nm }}</div>
                        </div>
                        
                        <div class="product-info">
                            <div class="info-label">ê°€ì…ë°©ë²•</div>
                            <div class="info-value">{{ product.join_way|default:"ì˜¨ë¼ì¸ ê°€ì… ê°€ëŠ¥" }}</div>
                        </div>
                        
                        <div class="product-tags">
                            <span class="tag">#ì„±ì¸ìš°ëŒ€í˜œíƒ</span>
                            <span class="tag">#ì ê¸ˆ</span>
                            <span class="tag">#ì €ì¶•</span>
                            {% if "ë§Œ15ì„¸ë¶€í„°" in product.join_way %}
                                <span class="tag">#ë§Œ15ì„¸ë¶€í„° ê°€ì…ê°€ëŠ¥</span>
                            {% endif %}
                        </div>
                    </div>
                {% empty %}
                    <p>ì ê¸ˆ ìƒí’ˆì´ ì—†ìŠµë‹ˆë‹¤.</p>
                {% endfor %}
            </div>
            
            <!-- ì ê¸ˆ í˜ì´ì§€ë„¤ì´ì…˜ -->
            {% if savings.has_other_pages %}
                <div class="pagination-container">
                    <div class="pagination">
                        {% if savings.has_previous %}
                            <a href="?savings_page={{ savings.previous_page_number }}">&lsaquo; ì´ì „</a>
                        {% endif %}
                        
                        {% for num in savings.paginator.page_range %}
                            {% if num <= 5 %}
                                {% if savings.number == num %}
                                    <span class="current">{{ num }}</span>
                                {% else %}
                                    <a href="?savings_page={{ num }}">{{ num }}</a>
                                {% endif %}
                            {% endif %}
                        {% endfor %}
                        
                        {% if savings.has_next %}
                            <a href="?savings_page={{ savings.next_page_number }}">ë‹¤ìŒ &rsaquo;</a>
                        {% endif %}
                    </div>
                    <div class="pagination-info">
                        {{ savings.start_index }}-{{ savings.end_index }} / ì´ {{ savings_total }}ê°œ
                    </div>
                </div>
            {% endif %}
        </div>

        <!-- ëŒ€ì¶œ ìƒí’ˆ ì„¹ì…˜ -->
        <div class="products-section" data-category="loan" style="display: none;">
            <h2 class="section-title">ëŒ€ì¶œ ìƒí’ˆ (ì¤€ë¹„ì¤‘)</h2>
            <div class="products-grid">
                <div class="product-cards">
                    <span class="product-badge">ëŒ€ì¶œ/ì§€ì›</span>
                    <h3 class="product-name">ëŒ€ì¶œ ìƒí’ˆ ì¤€ë¹„ì¤‘</h3>
                    <p class="product-subtitle">ê³§ ë‹¤ì–‘í•œ ëŒ€ì¶œ ìƒí’ˆì„ ë§Œë‚˜ë³´ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                    
                    <div class="product-info">
                        <div class="info-label">ìƒíƒœ</div>
                        <div class="info-value">ì¤€ë¹„ì¤‘</div>
                    </div>
                    
                    <div class="product-tags">
                        <span class="tag">#ì¤€ë¹„ì¤‘</span>
                    </div>
                </div>
            </div>
        </div>
    {% endif %}
</div>

<script src="{% static 'product_recommendation/js/product_list.js' %}"></script>
{% endblock %}